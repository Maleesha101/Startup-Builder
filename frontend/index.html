<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent Startup Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .loader {
            border-top-color: #3498db;
            -webkit-animation: spinner 1.5s linear infinite;
            animation: spinner 1.5s linear infinite;
        }

        @keyframes spinner {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-900 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-5xl">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-bold text-indigo-600 mb-2">Multi-Agent Startup Builder</h1>
            <p class="text-gray-600">Enter your product idea and watch specialized agents build your prototype.</p>
        </header>

        <!-- Input Section -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <label class="block text-sm font-medium text-gray-700 mb-2">Your Startup Idea</label>
            <div class="flex gap-4">
                <input type="text" id="ideaInput"
                    class="flex-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-lg p-3 border"
                    placeholder="e.g. An AI-powered habit tracking app for busy professionals"
                    value="An AI-powered habit tracking app for busy professionals">
                <button onclick="buildStartup()"
                    class="bg-indigo-600 text-white px-6 py-3 rounded-md hover:bg-indigo-700 font-medium transition-colors flex items-center gap-2">
                    <span id="btnText">Build Startup</span>
                    <i data-lucide="rocket" class="w-5 h-5"></i>
                </button>
            </div>
        </div>

        <!-- Loading State -->
        <div id="loadingActions" class="hidden text-center py-12">
            <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4 mx-auto">
            </div>
            <h2 class="text-xl font-semibold text-gray-700">Agents are working...</h2>
            <p class="text-gray-500 mt-2" id="statusMessage">Orchestrating agents...</p>
        </div>

        <!-- Results Section -->
        <div id="resultsArea" class="hidden space-y-8">

            <!-- Agent Cards Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Product -->
                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-blue-500">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">üß† Product Agent</h3>
                        <a href="/artifacts/prioritized_features.json" target="_blank"
                            class="text-blue-600 hover:underline text-sm">Download JSON</a>
                    </div>
                    <div class="h-40 overflow-y-auto bg-gray-50 p-3 rounded text-xs font-mono" id="productContent">
                    </div>
                </div>

                <!-- Architecture -->
                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-purple-500">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">üèó Architecture Agent</h3>
                        <a href="/artifacts/architecture.json" target="_blank"
                            class="text-blue-600 hover:underline text-sm">Download JSON</a>
                    </div>
                    <div class="h-40 overflow-y-auto bg-gray-50 p-3 rounded text-xs font-mono" id="archContent"></div>
                </div>

                <!-- Timeline -->
                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-yellow-500">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">üìÖ Timeline Agent</h3>
                        <a href="/artifacts/tasks.csv" target="_blank"
                            class="text-blue-600 hover:underline text-sm">Download CSV</a>
                    </div>
                    <div class="h-40 overflow-y-auto bg-gray-50 p-3 rounded text-xs font-mono" id="timelineContent">
                    </div>
                </div>

                <!-- Finance -->
                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-green-500">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">üí∞ Finance Agent</h3>
                        <a href="/artifacts/cost_estimate.csv" target="_blank"
                            class="text-blue-600 hover:underline text-sm">Download CSV</a>
                    </div>
                    <div class="h-40 overflow-y-auto bg-gray-50 p-3 rounded text-xs font-mono" id="financeContent">
                    </div>
                </div>

                <!-- Marketing -->
                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-pink-500">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold">üì¢ Marketing Agent</h3>
                        <a href="/artifacts/launch_plan.md" target="_blank"
                            class="text-blue-600 hover:underline text-sm">View Plan</a>
                    </div>
                    <div class="h-40 overflow-y-auto bg-gray-50 p-3 rounded text-xs font-mono" id="marketingContent">
                    </div>
                </div>
            </div>

            <!-- Download All -->
            <div class="text-center pt-8">
                <button class="bg-gray-800 text-white px-8 py-3 rounded-full font-bold hover:bg-gray-700 transition">
                    Download Full Project Zip (Coming Soon)
                </button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        async function buildStartup() {
            const idea = document.getElementById('ideaInput').value;
            if (!idea) return alert("Please enter an idea");

            // UI State
            document.getElementById('loadingActions').classList.remove('hidden');
            document.getElementById('resultsArea').classList.add('hidden');
            document.getElementById('btnText').innerText = "Building...";

            try {
                const response = await fetch('/build', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ idea })
                });

                const result = await response.json();

                if (result.status === 'success') {
                    renderResults(result.artifacts);
                } else {
                    alert('Error: ' + result.message);
                }
            } catch (e) {
                alert('Network error: ' + e);
            } finally {
                document.getElementById('loadingActions').classList.add('hidden');
                document.getElementById('btnText').innerText = "Build Startup";
            }
        }

        function renderResults(artifacts) {
            document.getElementById('resultsArea').classList.remove('hidden');

            // Helper to fill content
            const fill = (id, content) => {
                const schema = typeof content === 'object' ? JSON.stringify(content, null, 2) : content;
                document.getElementById(id).innerText = schema;
            };

            fill('productContent', artifacts.product);
            fill('archContent', artifacts.architecture);
            fill('timelineContent', artifacts.timeline);
            fill('financeContent', artifacts.finance);
            fill('marketingContent', artifacts.marketing);
        }
    </script>
</body>

</html>